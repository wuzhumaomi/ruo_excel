(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cd96acee"],{15:function(e,t){},16:function(e,t){},17:function(e,t){},18:function(e,t){},19:function(e,t){},20:function(e,t){},"71db":function(e,t){e.exports="data:image/png;base64,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"},"86bd":function(e,t,n){},"90fe":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dashboard-container",attrs:{"element-loading-text":"拼命解析中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{dragover:e.fileDragover,drop:e.fileDrop}},[e._m(0),a("div",{staticClass:"titleText hui"},[e._v(" 只能上传Excel文件 ")]),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",multiple:!1,"auto-upload":!1,"file-list":e.fileList,limit:10,"before-remove":e.beforeRemove,"on-change":e.handleChange,action:"https://jsonplaceholder.typicode.com/posts/"}},[a("img",{attrs:{src:n("71db"),alt:"",srcset:""}}),a("div",{staticClass:"el-upload__text"},[e._v("将Excel文件拖到此处，或"),a("em",[e._v("点击上传")])])]),a("div",{staticStyle:{"max-width":"900px",margin:"10px auto"}},[a("div",{staticClass:"lan",on:{click:function(t){e.ifBy=!e.ifBy}}},[e._v(" 在线同步表格 ")]),e.ifBy?a("h1",{staticClass:"marginTop26"},[e._v("1. 设置通用表里的 key (module[这里使用表格的那个值])")]):e._e(),e.ifBy?a("el-input",{attrs:{placeholder:"请输入列头数据依据"},on:{change:e.inputChange2},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}):e._e(),a("br"),a("br"),e.ifBy?a("el-input",{attrs:{placeholder:"请输入密钥"},model:{value:e.miyao,callback:function(t){e.miyao=t},expression:"miyao"}}):e._e(),a("br"),a("br"),e.ifBy?a("el-input",{attrs:{placeholder:"请输入表格Token"},model:{value:e.biaoToken,callback:function(t){e.biaoToken=t},expression:"biaoToken"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getSpreadsheets},slot:"append"})],1):e._e(),a("br"),a("br"),e.ifBy&&e.spreadsheets.sheets?a("div",[a("h1",[e._v("表格名称："+e._s(e.spreadsheets.properties.title)+" ")]),a("br"),e._l(e.spreadsheets.sheets,(function(t,n){return a("div",{key:n,staticClass:"lan",on:{click:function(n){return e.getSpreadsheetsValue(t.sheetId,t.rowCount)}}},[e._v(" "+e._s(t.title)+" "),a("br"),a("br")])}))],2):e._e(),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.sheetId,expression:"sheetId"}],staticClass:"tag-read2",attrs:{type:"primary","data-clipboard-text":e.sheetText},on:{click:function(t){return e.copy(".tag-read2")}}},[e._v("复制代码")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.sheetId,expression:"sheetId"}],staticClass:"textarea_box",staticStyle:{"white-space":"pre-wrap"},attrs:{contenteditable:"true",id:"sheetText"},domProps:{innerHTML:e._s(e.sheetText)}})],1),e.excelFile?a("h1",{staticClass:"marginTop26"},[e._v("1. 设置通用表里的 key (module[这里使用表格的那个值])")]):e._e(),e.excelFile?a("el-input",{attrs:{placeholder:"请输入列头数据依据"},on:{change:e.inputChange},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}):e._e(),a("br"),a("br"),e.excelFile?a("h1",{staticClass:"marginTop26"},[e._v("3. 选择Excel 工作表表单列表")]):e._e(),e._l(e.htmlData,(function(t,n){return a("div",{key:"01"+n,staticClass:"excelTitle marginTop26",class:{redText:e.show==t.id},on:{click:function(n){e.show=t.id}}},[a("h4",[e._v(e._s(t.wsname))])])})),e._l(e.htmlData,(function(t,n){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.show==t.id,expression:"show == i.id"}],key:"02"+n},[a("div",{staticClass:"marginTop26"},[a("el-button",{staticClass:"tag-read",attrs:{type:"primary","data-clipboard-text":t.text},on:{click:function(t){return e.copy(".tag-read")}}},[e._v("复制代码")]),a("el-button",{on:{click:function(n){return e.selectText(t.id)}}},[e._v("全选代码")]),e._v(" ( ps:下方代码可在线修改 ) ")],1),a("div",{staticClass:"textarea_box",staticStyle:{"white-space":"pre-wrap"},attrs:{contenteditable:"true",id:t.id},domProps:{innerHTML:e._s(t.text)}})])}))],2)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"titleText"},[n("h1",[e._v("Excel翻译成lua脚本在线版")])])}],i=n("b85c"),s=n("3835"),r=n("c7eb"),l=n("2909"),c=n("1da1"),h=n("5530"),d=(n("e9c4"),n("99af"),n("ac1f"),n("5319"),n("d3b7"),n("ddb0"),n("b0c0"),n("00b4"),n("2f62")),u=n("bc3a"),p=n.n(u),f=n("1146"),g=n.n(f),m=n("b311"),v=n.n(m),x=(n("1503"),{name:"Dashboard",computed:Object(h["a"])({},Object(d["b"])(["name"])),components:{},data:function(){return{excelSheets:{},dialogTableVisible:!1,ifShow:!1,show:"",input:"",textarea:"",htmlData:[],excelFile:null,fileList:[],loading:!1,ifBy:!1,tenant_access_token:"",biaoToken:"",spreadsheets:{},sheetId:"",sheetText:"",sheetData:"",miyao:"",time:0}},mounted:function(){var e=this;this.postFun("/user","GET",{}).then((function(e){console.log("/user",e)}));this.getToken(),setInterval((function(t){e.time--}),1e3),setTimeout((function(){e.miyao=localStorage.getItem("miyao"),e.biaoToken=localStorage.getItem("biaoToken"),e.input=localStorage.getItem("inputText"),e.tenant_access_token=e.$store.getters.tenant_access_token}),1e3)},methods:{getToken:function(){},getSpreadsheets:function(){var e=this;if("dream"==this.miyao){var t=this.biaoToken;localStorage.setItem("biaoToken",t),localStorage.setItem("miyao",this.miyao),localStorage.setItem("inputText",this.input||""),this.$Leancloud.dataRequest.postGet({url:"https://open.feishu.cn/open-apis/sheets/v2/spreadsheets/".concat(t,"/metainfo"),headers:{Authorization:"Bearer "+this.tenant_access_token},data:{}}).then((function(t){console.log("表信息",t),e.spreadsheets=t.data}))}},setSheetText:function(){var e=this.sheetData;this.sheetText="local module = {}\n  -- module['注释'] = ".concat(JSON.stringify(e[0]),"\n                      ");for(var t=1;t<e.length;t++){var n=e[t];this.sheetText+="\n  module[".concat(this.input?"'"+n[this.input]+"'":t,"] = ").concat(JSON.stringify(n))}this.sheetText+="\n\n return module",this.sheetText=this.sheetText.replace(/:/g,"=").replace(/{"/g,"{").replace(/,"/g,",").replace(/"=/g,"=").replace(/"{/g,"{").replace(/}"/g,"}").replace(/=\/\//g,"://")},getSpreadsheetsValue_post:function(e,t,n,a){var o=this;return Object(c["a"])(Object(r["a"])().mark((function i(){var s,c,h;return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return s=null,c=null,o.sheetId=e,h=o.biaoToken,i.next=6,o.$Leancloud.dataRequest.postGet({url:"https://open.feishu.cn/open-apis/sheets/v2/spreadsheets/".concat(h,"/values/").concat(e,"!A").concat(t,":ZZ")+(t+n),headers:{Authorization:"Bearer "+o.tenant_access_token},data:{}}).then((function(e){var t=e.data.valueRange.values,n=[];a&&(t=[a].concat(Object(l["a"])(t)));for(var o=1;o<t.length;o++){var i=t[o],r=i.some((function(e){return null!=e}));if(r){for(var h={},d=0;d<i.length;d++){var u=i[d];t[0][d]&&u&&(h[t[0][d]]=u)}n.push(h)}}s=n,c=t[0]}));case 6:return i.sent,i.abrupt("return",[s,c]);case 8:case"end":return i.stop()}}),i)})))()},getSpreadsheetsValue:function(e,t){var n=this;return Object(c["a"])(Object(r["a"])().mark((function a(){var o,i,c,h,d,u,p,f;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!(n.time>0)){a.next=2;break}return a.abrupt("return");case 2:n.time=3,o=t,i=1,c=[],h=null,d=null;case 8:if(!(o>0)){a.next=21;break}return a.next=11,n.getSpreadsheetsValue_post(e,i,1500,h);case 11:u=a.sent,p=Object(s["a"])(u,2),f=p[0],d=p[1],1==i&&(h=d),c=[].concat(Object(l["a"])(c),Object(l["a"])(f)),o-=1500,i+=1500,a.next=8;break;case 21:n.sheetData=c,n.setSheetText();case 23:case"end":return a.stop()}}),a)})))()},postFun:function(e,t,n){var a="https://suibianba.yuque.com/api/v2";return p()({method:t,headers:{"Content-Type":"application/json","User-Agent":"sbb","X-Auth-Token":this.token},data:n,url:a+e})},tokenChange:function(){},ifDialogShow:function(){this.dialogTableVisible=!0},openFile:function(){this.$refs.upload.$children[0].handleClick()},fileDragover:function(e){e.preventDefault(),console.log("拖拽上传",e)},fileDrop:function(e){e.preventDefault();e.dataTransfer.files[0]},onDrag:function(e){e.stopPropagation(),e.preventDefault(),this.ifShow=!1},onDrag2:function(e){e.stopPropagation(),e.preventDefault(),this.ifShow=!0},onDrop:function(e){console.log("3. onDrop e ",e),e.stopPropagation(),e.preventDefault();e.dataTransfer.files[0];this.readExcel(e)},handleChange:function(e,t){console.log(" 选择文件 ",e,t);var n=n||window.event;this.fileList=[e],this.readExcel(e.raw),this.excelFile=e.raw},beforeRemove:function(e,t){return console.log(" 移除文件 ",e,t),this.$confirm("确定移除 ".concat(e.name,"？"))},copy:function(e){var t=this,n=new v.a(e);n.on("success",(function(e){console.log("复制成功",n),t.$message({message:"已复制到剪切板，Ctrl + v去吧！！",type:"success"}),n.destroy()})),n.on("error",(function(e){console.log("该浏览器不支持复制",n),n.destroy()}))},cloneCode:function(e){},inputChange2:function(e){console.log(e),this.setSheetText()},inputChange:function(e){console.log(e),this.readExcel(this.excelFile),this.readExcel(this.excelFile)},selectText:function(e){var t=document.getElementById(e);if(document.body.createTextRange){var n=document.body.createTextRange();n.moveToElementText(t),n.select()}else if(window.getSelection){var a=window.getSelection();n=document.createRange();n.selectNodeContents(t),a.removeAllRanges(),a.addRange(n)}else alert("none")},readExcel:function(e){var t=this;this.loading=!0;var n=this,a=[e];if(console.log("表格",a),a.length<=0)return!1;if(!/\.(xls|xlsx)$/.test(a[0].name.toLowerCase()))return this.$Message.error("上传格式不正确，请上传xls或者xlsx格式"),!1;console.log("-- 内容 --");var o=new FileReader;o.onload=function(e){var a=e.target.result,o=g.a.read(a,{type:"binary"});console.log("表格具体信息",o),n.htmlData=[];var r,l=Object(i["a"])(o.SheetNames.entries());try{for(l.s();!(r=l.n()).done;){var c=Object(s["a"])(r.value,2),h=c[0],d=c[1],u=d;console.log("表格",h,d);var p=g.a.utils.sheet_to_json(o.Sheets[u]);console.log("表格内容 ",p),n.htmlData[h]={},n.htmlData[h].id="id_"+h,n.htmlData[h].wsname=u,n.htmlData[h].text="local module = {}\n\n\t-- module['注释'] = ".concat(JSON.stringify(p[0]),"\n              ");for(var f=1;f<p.length;f++){var m=p[f];n.htmlData[h].text+="\n\tmodule[".concat(n.input?"'"+m[n.input]+"'":f,"] = ").concat(JSON.stringify(m))}n.htmlData[h].text+="\nreturn module",n.htmlData[h].text=n.htmlData[h].text.replace(/:/g,"=").replace(/{"/g,"{").replace(/,"/g,",").replace(/"=/g,"=").replace(/"{/g,"{").replace(/}"/g,"}").replace(/=\/\//g,"://"),console.log("显示内容",n.htmlData[h].text)}}catch(v){l.e(v)}finally{l.f()}console.log("输出信息",n.htmlData),n.show=n.htmlData[0].id,t.loading=!1},o.readAsArrayBuffer(a[0])},readExcel2:function(e){var t=this;this.loading=!0;var n=this,a=[e];if(console.log("表格",a),a.length<=0)return!1;if(!/\.(xls|xlsx)$/.test(a[0].name.toLowerCase()))return this.$Message.error("上传格式不正确，请上传xls或者xlsx格式"),!1;console.log("-- 内容 --");var o=new FileReader;o.onload=function(e){var a=e.target.result,o=g.a.read(a,{type:"binary"});console.log("表格具体信息",o),n.htmlData=[];var r,l=Object(i["a"])(o.SheetNames.entries());try{for(l.s();!(r=l.n()).done;){var c=Object(s["a"])(r.value,2),h=c[0],d=c[1],u=d;console.log("表格",h,d);var p=g.a.utils.sheet_to_json(o.Sheets[u]);if(console.log("表格内容 ",p),0!=h)break;var f,m={},v=Object(i["a"])(p);try{for(v.s();!(f=v.n()).done;){var x=f.value;m[x[0]]||(x[1]||console.log(x),m[x[0]]={text:x[0],info:x[1].replace(/\n/g,"\r\n"),children:{}}),m[x[0]].children[x[2]]||(m[x[0]].children[x[2]]={text:x[2],info:x[3].replace(/\n/g,"\r\n"),children:{}}),x[4]&&!m[x[0]].children[x[2]].children[x[4]]&&(m[x[0]].children[x[2]].children[x[4]]={text:x[4],info:x[5].replace(/\n/g,"\r\n"),children:{}}),x[6]&&!m[x[0]].children[x[2]].children[x[4]].children[x[6]]&&(m[x[0]].children[x[2]].children[x[4]].children[x[6]]={text:x[6],info:x[7].replace(/\n/g,"\r\n"),children:{}}),x[8]&&!m[x[0]].children[x[2]].children[x[4]].children[x[6]].children[x[8]]&&(m[x[0]].children[x[2]].children[x[4]].children[x[6]].children[x[8]]={text:x[8],info:x[9].replace(/\n/g,"\r\n"),children:{}})}}catch(b){v.e(b)}finally{v.f()}n.htmlData[h]={},n.htmlData[h].id="id_"+h,n.htmlData[h].wsname=u,n.htmlData[h].text=JSON.stringify(m)}}catch(b){l.e(b)}finally{l.f()}console.log("输出信息",n.htmlData),n.show=n.htmlData[0].id,t.loading=!1},o.readAsArrayBuffer(a[0])}}}),b=x,y=(n("ee3a"),n("c824"),n("2877")),T=Object(y["a"])(b,a,o,!1,null,"32897a01",null);t["default"]=T.exports},b3db:function(e,t,n){},c824:function(e,t,n){"use strict";n("86bd")},ee3a:function(e,t,n){"use strict";n("b3db")}}]);